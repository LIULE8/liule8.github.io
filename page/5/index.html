<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Leo's notes</title><meta name="author" content="Leo Liu"><meta name="copyright" content="Leo Liu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="Leo&#39;s notes">
<meta property="og:url" content="https://liule8.github.io/page/5/index.html">
<meta property="og:site_name" content="Leo&#39;s notes">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://liule8.github.io/images/avatar.png">
<meta property="article:author" content="Leo Liu">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://liule8.github.io/images/avatar.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://liule8.github.io/page/5/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-10-27 11:17:39'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/images/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">322</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">82</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">46</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Leo's notes</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Leo's notes</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/LIULE8" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:leo.liu.scau@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/post/78d9701b.html" title="Netty 核心原理剖析与 RPC 实践之基础架构-引导器 Bootstrap">     <img class="post_bg" src="/images/posts/cover/netty.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Netty 核心原理剖析与 RPC 实践之基础架构-引导器 Bootstrap"></a></div><div class="recent-post-info"><a class="article-title" href="/post/78d9701b.html" title="Netty 核心原理剖析与 RPC 实践之基础架构-引导器 Bootstrap">Netty 核心原理剖析与 RPC 实践之基础架构-引导器 Bootstrap</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-10-10T21:01:10.000Z" title="发表于 2021-10-10 21:01:10">2021-10-10</time></span></div><div class="content">引导器作用：客户端和服务端启动都要做些什么？我们在使用 Netty 编写网络应用程序的时候，一定会从引导器 Bootstrap **开始入手。Bootstrap 作为整个 Netty 客户端和服务端的程序入口，可以把 Netty 的核心组件像搭积木一样组装在一起。接下来会从 Netty 的引导器 **Bootstrap 出发，带你学习如何使用 Netty 进行最基本的程序开发。
从一个简单的 HTTP 服务器开始HTTP 服务器是我们平时最常用的工具之一。同传统 Web 容器 Tomcat、Jetty 一样，Netty 也可以方便地开发一个 HTTP 服务器。我从一个简单的 HTTP 服务器开始，通过程序示例为你展现 Netty 程序如何配置启动，以及引导器如何与核心组件产生联系。
完整地实现一个高性能、功能完备、健壮性强的 HTTP 服务器非常复杂，本文仅为了方便理解 Netty 网络应用开发的基本过程，所以只实现最基本的请求-响应的流程：

搭建 HTTP 服务器，配置相关参数并启动。

从浏览器或者终端发起 HTTP 请求。

成功得到服务端的响应结果。


Netty 的模块化 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/post/27f20f1.html" title="Netty 核心原理剖析与 RPC 实践之基础架构-Netty 整体架构">     <img class="post_bg" src="/images/posts/cover/netty.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Netty 核心原理剖析与 RPC 实践之基础架构-Netty 整体架构"></a></div><div class="recent-post-info"><a class="article-title" href="/post/27f20f1.html" title="Netty 核心原理剖析与 RPC 实践之基础架构-Netty 整体架构">Netty 核心原理剖析与 RPC 实践之基础架构-Netty 整体架构</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-10-10T19:38:47.000Z" title="发表于 2021-10-10 19:38:47">2021-10-10</time></span></div><div class="content">纵览全局：把握 Netty 整体架构脉络以 Netty 4.1.42 为基准版本，将分别从 Netty 整体结构、逻辑架构、源码结构三个方面对其进行介绍。
Netty 整体结构Netty 是一个设计非常用心的网络基础组件，Netty 官网给出了有关 Netty 的整体功能模块结构，却没有其他更多的解释。从图中，我们可以清晰地看出 Netty 结构一共分为三个模块：


Core 核心层Core 核心层是 Netty 最精华的内容，它提供了底层网络通信的通用抽象和实现，包括可扩展的事件模型、通用的通信 API、支持零拷贝的 ByteBuf 等。

Protocol Support 协议支持层协议支持层基本上覆盖了主流协议的编解码实现，如 HTTP、SSL、Protobuf、压缩、大文件传输、WebSocket、文本、二进制等主流协议，此外 Netty 还支持自定义应用层协议。Netty 丰富的协议支持降低了用户的开发成本，基于 Netty 我们可以快速开发 HTTP、WebSocket 等服务。

Transport Service 传输服务层传输服务层提供了网络传输能力的定义和实现方法 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/post/aa984f90.html" title="Netty 核心原理剖析与 RPC 实践之基础架构-初识 Netty">     <img class="post_bg" src="/images/posts/cover/netty.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Netty 核心原理剖析与 RPC 实践之基础架构-初识 Netty"></a></div><div class="recent-post-info"><a class="article-title" href="/post/aa984f90.html" title="Netty 核心原理剖析与 RPC 实践之基础架构-初识 Netty">Netty 核心原理剖析与 RPC 实践之基础架构-初识 Netty</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-10-09T21:48:35.000Z" title="发表于 2021-10-09 21:48:35">2021-10-09</time></span></div><div class="content">初识 Netty：为什么 Netty 这么流行？众所周知，Java 的生态非常完善，同一类型的需求可能会有几款产品供你选择。那为什么 Java 的网络编程框架大家都会向你推荐 Netty，而不是 Java NIO、Mina、Grizzy 呢？
我们就一起来看看 Netty 为什么这么流行，它到底解决了什么问题，以及目前它的发展现状，让你对 Netty 有一个全面的认识。
为什么选择 Netty？Netty 是一款用于高效开发网络应用的 NIO 网络框架，它大大简化了网络应用的开发过程。我们所熟知的 TCP 和 UDP 的 Socket 服务器开发，就是一个有关 Netty 简化网络应用开发的典型案例。
既然 Netty 是网络应用框架，那我们永远绕不开以下几个核心关注点：

I/O 模型、线程模型和事件处理机制；
易用性 API 接口；
对数据协议、序列化的支持。

我们之所以会最终选择 Netty，是因为 Netty 围绕这些核心要点可以做到尽善尽美，其健壮性、性能、可扩展性在同领域的框架中都首屈一指。下面我们从以下三个方面一起来看看，Netty 到底有多厉害。
高性能，低延迟经常听 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/post/258d3def.html" title="Netty 原理与 API 网关">     <img class="post_bg" src="/images/posts/cover/netty.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Netty 原理与 API 网关"></a></div><div class="recent-post-info"><a class="article-title" href="/post/258d3def.html" title="Netty 原理与 API 网关">Netty 原理与 API 网关</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-10-08T18:45:34.000Z" title="发表于 2021-10-08 18:45:34">2021-10-08</time></span></div><div class="content">Netty 原理与 API 网关高性能什么是高性能
高并发用户（Concurrent Users）– 从业务的角度来衡量
可以在压测的时候模拟出某个请求的并发用户

高吞吐量（Throughout）– 从技术角度来衡量
QPS  读请求的吞吐量
TPS  写请求的吞吐量

低延迟（Latency）– 从技术角度来衡量

延迟（Latency）和 响应时间（Response Time）区别：


延迟： t4 - t3，针对的对象是系统；
响应时间： t2 - t1，针对的对象是客户
如果延迟很低，这两者的时间几乎没有区别

压测结果里的延迟一般是指响应时间，而且是用百分数来衡量系统的延迟，因为直接使用时间来衡量有可能被平均，就像你的收入和马云的收入一平均，你的收入就过千万了。


并发量要Hold的住，系统不能崩掉 –  代表了系统的海量并发的处理能力
QPS、TPS 要高，高吞吐，低延迟 – 代表了系统很好的服务能力
高性能的副作用
系统复杂度 x 10 以上 
可能你看到的网站的某个小页面就是一个系统，像淘宝网的收藏夹就是一个特别复杂的系统
一个并发几十的系统，和一个并发几千，上万 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/post/d2674844.html" title="Spring Security之基础功能-认证体系">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spring Security之基础功能-认证体系"></a></div><div class="recent-post-info"><a class="article-title" href="/post/d2674844.html" title="Spring Security之基础功能-认证体系">Spring Security之基础功能-认证体系</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-10-07T21:56:26.000Z" title="发表于 2021-10-07 21:56:26">2021-10-07</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Spring/">Spring</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/Spring/Spring-Security/">Spring Security</a></span></div><div class="content">认证体系：如何深入理解 Spring Security 用户认证机制？Spring Security 中的用户和认证Spring Security 中的认证过程由一组核心对象组成，大致可以分成两大类，一类是用户对象，一类是认证对象，下面来具体了解一下。
Spring Security 中的用户对象Spring Security 中的用户对象用来描述用户并完成对用户信息的管理，涉及UserDetails、GrantedAuthority、UserDetailsService 和 UserDetailsManager这四个核心对象。

UserDetails：描述 Spring Security 中的用户；
GrantedAuthority：定义用户的操作权限；
UserDetailsService：定义了对 UserDetails 的查询操作；
UserDetailsManager：扩展 UserDetailsService，添加了创建用户、修改用户密码等功能。

这四个对象之间的关联关系如下图所示，显然，对于由 UserDetails 对象所描述的一个用户而言，它应该具有 1 个或多个 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/post/415a7280.html" title="Spring Boot响应式编程之响应式测试-测试集成">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spring Boot响应式编程之响应式测试-测试集成"></a></div><div class="recent-post-info"><a class="article-title" href="/post/415a7280.html" title="Spring Boot响应式编程之响应式测试-测试集成">Spring Boot响应式编程之响应式测试-测试集成</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-10-07T21:20:33.000Z" title="发表于 2021-10-07 21:20:33">2021-10-07</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Spring-Boot/">Spring Boot</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/Spring-Boot/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B/">响应式编程</a></span></div><div class="content">测试集成：响应式 Web 应用程序如何进行测试？我们来看看如何测试 Web 三层架构中的各层组件，即 Repository 层、Service 层和 Controller 层。
与测试单纯的 Reactor 编程组件不同，Web 应用程序不同层的组件之间存在自上而下的依赖关系。因此，我们将从 Repository 层开始自下而上来开展测试工作，并将对这些组件的测试使用不同的方案和技术。
测试响应式 Repository 层组件与传统的关系型数据库一样，MongoDB 的测试也有两种主流的方法，一种是基于内置的嵌入式数据库，一种是基于真实的数据库。我们分别来看一下。
测试内嵌式 MongoDB测试内嵌式 MongoDB 需要引入 flapdoodle，这是一个内嵌式 MongoDB 数据库，与关系型数据库中所使用的 H2 内嵌式数据库类似，flapdoodle 允许我们在不使用真实 MongoDB 数据库的情况下编写测试用例并执行测试。
首先，在 Maven 中引入 flapdoodle 依赖的方法如下所示。
12345&lt;dependency&gt;        &lt;grou ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/post/b7feebae.html" title="Spring Boot响应式编程之响应式测试-测试方案">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spring Boot响应式编程之响应式测试-测试方案"></a></div><div class="recent-post-info"><a class="article-title" href="/post/b7feebae.html" title="Spring Boot响应式编程之响应式测试-测试方案">Spring Boot响应式编程之响应式测试-测试方案</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-10-07T20:55:53.000Z" title="发表于 2021-10-07 20:55:53">2021-10-07</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Spring-Boot/">Spring Boot</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/Spring-Boot/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B/">响应式编程</a></span></div><div class="content">测试方案：如何验证响应式编程组件的正确性？对于响应式系统而言，测试是一个难点。当一个应用程序中涉及数据层、服务层、Web 层以及各种外部服务之间的交互关系时，除了针对各层组件的独立测试之外，还需要充分引入集成测试来保证服务的正确性和稳定性。
全栈响应式测试方案在一个 Web 应用程序中，涉及测试的维度有很多，包括数据访问、服务构建和服务集成等。同时，基于常见的系统分层和代码组织结构，测试工作也体现为一种层次关系，即我们需要测试从 Repository 层到 Service 层、再到 Controller 层的完整业务链路。
而在响应式 Web 应用中，因为其推崇的是全栈式的响应式编程模型，所以每一层都需要对响应式组件进行测试。针对这一点，我梳理了如下所示的测试层次关系，并给出了各个层次中所使用到的主要测试实现方法。

不同层次的测试方法需要使用不同的测试工具和框架，我们将关注响应式 Web 应用程序中开展多维度测试的各种工具。此外，传统的以 JUnit 为代表的单元测试工具，以及各种 Mock 框架同样适用于响应式系统的测试。同时，我们也需要采用如上图中所展示的一些特有的测试工具类以及 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/post/dc154ad9.html" title="Spring Boot响应式编程之响应式消息通信-消息消费">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spring Boot响应式编程之响应式消息通信-消息消费"></a></div><div class="recent-post-info"><a class="article-title" href="/post/dc154ad9.html" title="Spring Boot响应式编程之响应式消息通信-消息消费">Spring Boot响应式编程之响应式消息通信-消息消费</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-10-07T20:35:02.000Z" title="发表于 2021-10-07 20:35:02">2021-10-07</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Spring-Boot/">Spring Boot</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/Spring-Boot/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B/">响应式编程</a></span></div><div class="content">消息消费：如何选择可用的高级开发技巧？案例集成：ReactiveSpringCSS 中的消息消费场景我们继续讨论 ReactiveSpringCSS 案例，根据整个消息交互流程，customer-service 就是 AccountChangedEvent 事件的消费者。根据交互流程，customer-service 需要把变更后的用户账户信息更新到 Redis 缓存中。
在 Spring Cloud Stream 中，负责消费消息的是 Sink 组件。因此，我们同样围绕 AccountChangedEvent 事件研究 customer -service 内部的整个实现流程，如下图所示。

在上图中，AccountChangedEvent 事件通过消息中间件发送到 Reactive Spring Cloud Stream 中，Reactive Spring Cloud Stream 通过 Sink 获取消息并交由 ReactiveAccountChangedSink 实现具体的消费逻辑。结合前面提到的消息消费场景下的缓存处理需求，可以想象这个 ReactiveAccountChang ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/post/b9c0ff78.html" title="Spring Boot响应式编程之响应式消息通信-消息发布">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spring Boot响应式编程之响应式消息通信-消息发布"></a></div><div class="recent-post-info"><a class="article-title" href="/post/b9c0ff78.html" title="Spring Boot响应式编程之响应式消息通信-消息发布">Spring Boot响应式编程之响应式消息通信-消息发布</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-10-07T19:58:10.000Z" title="发表于 2021-10-07 19:58:10">2021-10-07</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Spring-Boot/">Spring Boot</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/Spring-Boot/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B/">响应式编程</a></span></div><div class="content">消息发布：如何以响应式的编程方式发送消息？案例集成：消息通信机制与 ReactiveSpringCSS 案例让我们回到 ReactiveSpringCSS 系统，在案例中分别提取 account-service、order-service 和 customer-service 这三个独立的 Web 服务。显然，它们之间需要进行服务之间的调用和协调，从而完成业务闭环。如果在不久的将来，案例系统中需要引入其他服务才能形成完整的业务流程，那么这个业务闭环背后的交互模式就需要进行相应的调整。
在 ReactiveSpringCSS 案例中，你可以想象一个用户的账户信息变动并不会太频繁。因为 account-service 和 customer-service 分别位于两个服务中，为了降低远程交互的成本，很多时候我们会想到把用户的账户信息集中放在缓存里，并在客户工单生成过程中直接从缓存中获取用户账户。那么，在这样的设计和实现方式下，试想一旦某个用户账户信息发生变化，我们应该如何正确和高效地应对这一场景呢？
一种思路是系统基于一定的时间间隔定时访问 account-service，来获取用户账户信 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/post/617de7a8.html" title="Spring Boot响应式编程之响应式消息通信-消息驱动">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spring Boot响应式编程之响应式消息通信-消息驱动"></a></div><div class="recent-post-info"><a class="article-title" href="/post/617de7a8.html" title="Spring Boot响应式编程之响应式消息通信-消息驱动">Spring Boot响应式编程之响应式消息通信-消息驱动</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-10-07T19:29:10.000Z" title="发表于 2021-10-07 19:29:10">2021-10-07</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Spring-Boot/">Spring Boot</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/Spring-Boot/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B/">响应式编程</a></span></div><div class="content">消息驱动：Spring Cloud Stream 如何为系统提升伸缩性？Spring Cloud Stream 基本架构Spring Cloud Streams 为异步跨服务消息通信提供了简化的编程模型。Spring Cloud Stream 能够构建具有高度伸缩性的应用程序，而无须处理过于复杂的配置，也无须深入了解特定的消息中间件。
Spring Cloud Stream 工作流程Spring Cloud Stream 中有三个角色，即消息的发布者、消费者以及消息通信系统本身，以消息通信系统为中心，整个工作流程表现为一种对称结构，如下图所示。

在上图中，充当消息发布者的服务 A 根据业务需要产生消息发送的需求，Spring Cloud Stream 中的 Source 组件是真正生成消息的组件，然后消息通过 Channel 传送到 Binder，这里的 Binder 是一个抽象组件，通过 Binder，Channel 可以与特定的消息中间件进行通信。在 Spring Cloud Stream 中，目前已经内置集成的消息中间件实现工具包括 RabbitMQ 和 Kafka。
另一方面 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/4/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/#content-inner">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/#content-inner">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/33/#content-inner">33</a><a class="extend next" rel="next" href="/page/6/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/images/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Leo Liu</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">322</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">82</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">46</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/liule8"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/LIULE8" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:leo.liu.scau@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">这里是公告</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/4a488f3.html" title="趣学设计模式之编程思维-对象思维"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="趣学设计模式之编程思维-对象思维"/></a><div class="content"><a class="title" href="/post/4a488f3.html" title="趣学设计模式之编程思维-对象思维">趣学设计模式之编程思维-对象思维</a><time datetime="2021-10-27T12:51:33.000Z" title="发表于 2021-10-27 12:51:33">2021-10-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/fa834f18.html" title="趣学设计模式之编程思维-工程思维"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="趣学设计模式之编程思维-工程思维"/></a><div class="content"><a class="title" href="/post/fa834f18.html" title="趣学设计模式之编程思维-工程思维">趣学设计模式之编程思维-工程思维</a><time datetime="2021-10-27T09:25:34.000Z" title="发表于 2021-10-27 09:25:34">2021-10-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/3de10f44.html" title="趣学设计模式之编程思维-分层思维"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="趣学设计模式之编程思维-分层思维"/></a><div class="content"><a class="title" href="/post/3de10f44.html" title="趣学设计模式之编程思维-分层思维">趣学设计模式之编程思维-分层思维</a><time datetime="2021-10-26T16:12:49.000Z" title="发表于 2021-10-26 16:12:49">2021-10-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/f50b517d.html" title="趣学设计模式之编程思维-组合思维"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="趣学设计模式之编程思维-组合思维"/></a><div class="content"><a class="title" href="/post/f50b517d.html" title="趣学设计模式之编程思维-组合思维">趣学设计模式之编程思维-组合思维</a><time datetime="2021-10-26T15:04:28.000Z" title="发表于 2021-10-26 15:04:28">2021-10-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/50738ec5.html" title="趣学设计模式之编程模式-"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="趣学设计模式之编程模式-"/></a><div class="content"><a class="title" href="/post/50738ec5.html" title="趣学设计模式之编程模式-">趣学设计模式之编程模式-</a><time datetime="2021-10-26T13:07:00.000Z" title="发表于 2021-10-26 13:07:00">2021-10-26</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/JDK/"><span class="card-category-list-name">JDK</span><span class="card-category-list-count">4</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/JDK/JDK8/"><span class="card-category-list-name">JDK8</span><span class="card-category-list-count">4</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/"><span class="card-category-list-name">Java</span><span class="card-category-list-count">83</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"><span class="card-category-list-name">多线程</span><span class="card-category-list-count">81</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/JavaScript/"><span class="card-category-list-name">JavaScript</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MQ/"><span class="card-category-list-name">MQ</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Spring/"><span class="card-category-list-name">Spring</span><span class="card-category-list-count">55</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Spring/Spring-Data/"><span class="card-category-list-name">Spring Data</span><span class="card-category-list-count">33</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Spring/" style="font-size: 1.4em; color: rgb(125, 186, 146)">Spring</a><a href="/tags/JPA/" style="font-size: 1.15em; color: rgb(37, 53, 173)">JPA</a><a href="/tags/Spring-Data/" style="font-size: 1.35em; color: rgb(54, 88, 32)">Spring Data</a><a href="/tags/Spring-Data-JPA/" style="font-size: 1.38em; color: rgb(188, 80, 161)">Spring Data JPA</a><a href="/tags/Vue/" style="font-size: 1.17em; color: rgb(113, 74, 27)">Vue</a><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/" style="font-size: 1.15em; color: rgb(96, 147, 78)">面向对象设计原则</a><a href="/tags/%E6%9E%B6%E6%9E%84/" style="font-size: 1.17em; color: rgb(31, 196, 19)">架构</a><a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 1.22em; color: rgb(151, 109, 27)">算法</a><a href="/tags/UML/" style="font-size: 1.17em; color: rgb(55, 153, 110)">UML</a><a href="/tags/%E9%94%81/" style="font-size: 1.17em; color: rgb(37, 87, 170)">锁</a><a href="/tags/%E9%9B%86%E5%90%88/" style="font-size: 1.15em; color: rgb(144, 52, 17)">集合</a><a href="/tags/%E5%B9%B6%E5%8F%91/" style="font-size: 1.17em; color: rgb(155, 131, 28)">并发</a><a href="/tags/%E6%B3%A8%E8%A7%A3/" style="font-size: 1.22em; color: rgb(132, 67, 191)">注解</a><a href="/tags/JVM/" style="font-size: 1.25em; color: rgb(129, 29, 147)">JVM</a><a href="/tags/Java/" style="font-size: 1.45em; color: rgb(30, 126, 142)">Java</a><a href="/tags/CompletableFuture/" style="font-size: 1.15em; color: rgb(1, 4, 194)">CompletableFuture</a><a href="/tags/Future/" style="font-size: 1.15em; color: rgb(166, 22, 190)">Future</a><a href="/tags/JavaScript/" style="font-size: 1.15em; color: rgb(140, 115, 137)">JavaScript</a><a href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" style="font-size: 1.42em; color: rgb(134, 128, 12)">并发编程</a><a href="/tags/%E7%BA%BF%E7%A8%8B/" style="font-size: 1.42em; color: rgb(19, 74, 167)">线程</a><a href="/tags/MySQL/" style="font-size: 1.32em; color: rgb(148, 24, 70)">MySQL</a><a href="/tags/I-O%E6%A8%A1%E5%9E%8B/" style="font-size: 1.38em; color: rgb(141, 104, 38)">I\O模型</a><a href="/tags/Netty/" style="font-size: 1.38em; color: rgb(4, 176, 85)">Netty</a><a href="/tags/Socket%E7%BC%96%E7%A8%8B/" style="font-size: 1.38em; color: rgb(110, 57, 65)">Socket编程</a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.17em; color: rgb(96, 145, 169)">数据库</a><a href="/tags/Oracle/" style="font-size: 1.17em; color: rgb(189, 197, 90)">Oracle</a><a href="/tags/SQL/" style="font-size: 1.17em; color: rgb(162, 81, 27)">SQL</a><a href="/tags/pageable/" style="font-size: 1.15em; color: rgb(167, 146, 97)">pageable</a><a href="/tags/RestTemplate/" style="font-size: 1.15em; color: rgb(59, 117, 20)">RestTemplate</a><a href="/tags/String/" style="font-size: 1.3em; color: rgb(192, 87, 140)">String</a><a href="/tags/Springboot/" style="font-size: 1.2em; color: rgb(177, 91, 194)">Springboot</a><a href="/tags/Annotation/" style="font-size: 1.17em; color: rgb(194, 17, 185)">Annotation</a><a href="/tags/JpaSpecificationExecutor/" style="font-size: 1.2em; color: rgb(119, 61, 45)">JpaSpecificationExecutor</a><a href="/tags/%E4%B9%90%E8%A7%82%E9%94%81/" style="font-size: 1.15em; color: rgb(198, 0, 64)">乐观锁</a><a href="/tags/Spring-Security/" style="font-size: 1.27em; color: rgb(103, 6, 126)">Spring Security</a><a href="/tags/Transaction/" style="font-size: 1.15em; color: rgb(174, 89, 178)">Transaction</a><a href="/tags/redis/" style="font-size: 1.15em; color: rgb(73, 113, 141)">redis</a><a href="/tags/Join/" style="font-size: 1.15em; color: rgb(73, 163, 43)">Join</a><a href="/tags/Time/" style="font-size: 1.15em; color: rgb(90, 32, 71)">Time</a><a href="/tags/Mixin/" style="font-size: 1.17em; color: rgb(76, 166, 31)">Mixin</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/10/"><span class="card-archive-list-date">十月 2021</span><span class="card-archive-list-count">86</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/09/"><span class="card-archive-list-date">九月 2021</span><span class="card-archive-list-count">106</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/08/"><span class="card-archive-list-date">八月 2021</span><span class="card-archive-list-count">27</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/07/"><span class="card-archive-list-date">七月 2021</span><span class="card-archive-list-count">21</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/06/"><span class="card-archive-list-date">六月 2021</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/04/"><span class="card-archive-list-date">四月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/02/"><span class="card-archive-list-date">二月 2021</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/01/"><span class="card-archive-list-date">一月 2021</span><span class="card-archive-list-count">11</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">322</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">961.6k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2021-10-27T11:17:36.032Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Leo Liu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  fetch('https://api.btstu.cn/yan/api.php?charset=utf-8&encode=json')
    .then(response => response.json())
    .then(data => {
      if (true) {
        var sub = "".length == 0 ? new Array() : "".split(',')
        var both = sub.unshift(data.text)
        typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = data.text
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>