<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Leo's notes</title><meta name="author" content="Leo Liu"><meta name="copyright" content="Leo Liu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="Leo&#39;s notes">
<meta property="og:url" content="https://liule8.github.io/page/38/index.html">
<meta property="og:site_name" content="Leo&#39;s notes">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://liule8.github.io/images/avatar.png">
<meta property="article:author" content="Leo Liu">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://liule8.github.io/images/avatar.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://liule8.github.io/page/38/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-11-20 13:32:59'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/images/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">400</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">84</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">51</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Leo's notes</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Leo's notes</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/LIULE8" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:leo.liu.scau@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/post/707bc39e.html" title="PlantUML语法">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PlantUML语法"></a></div><div class="recent-post-info"><a class="article-title" href="/post/707bc39e.html" title="PlantUML语法">PlantUML语法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-21T15:40:59.000Z" title="发表于 2020-09-21 15:40:59">2020-09-21</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/UML/">UML</a></span></div><div class="content">PlantUML语法
安装
官方站点

需要 java 环境。
需要安装 Graphviz 依赖
下载 plantuml

使用 IDEA 来创建和预览

下载 IDEA 编辑器
打开 Plugins 搜索 “plantuml”，选中 PlantUML integration，点击安装即可
配置 PlantUML


脚本语法
puml 是脚本语言，是按照换行来识别语法的。
一般的表达语句为:


节点  连接符号  节点


关键字  节点或内容


开始关键字
  内容
结束关键字
123456789101112131415&gt; 注意**空格**等非字符作为节点内容的使用，有些多关键字语句中需要使用**双引号**来包含带空格的语句### 活动图 ( Activity Diagram )#### Simple Activity语法是 &#96;: 节点 ;&#96; 结束&#96;&#96;&#96;plantuml@startumltitle act_new_1:步骤一;:此处有个支持简单的 mark 语法 **加粗字体**;@enduml





Start / Stop  ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/post/f9c29644.html" title="面向对象设计原则">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="面向对象设计原则"></a></div><div class="recent-post-info"><a class="article-title" href="/post/f9c29644.html" title="面向对象设计原则">面向对象设计原则</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-15T20:24:26.000Z" title="发表于 2020-09-15 20:24:26">2020-09-15</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9E%B6%E6%9E%84/">架构</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E6%9E%B6%E6%9E%84/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/">面向对象设计原则</a></span></div><div class="content">面向对象设计原则
面向对象设计（OOD：Object Oriented Design）的六大设计原则



缩写
英文名称
中文名称




SRP
Single Responsibility Principle
单一职责原则


OCP
Open Close Principle
开闭原则


LSP
Liskov Substitution Principle
里氏替换原则


ISP
Interface Segregation Principle
接口分离原则


DIP
Dependency Inversion Principle
依赖倒置原则


LoD
Law of Demeter （ Least Knowledge Principle）
迪米特法则（最少知道原则）




前五个设计原则就是通常所说的SOLID（上方表格缩写的首字母，从上到下）

开闭原则 ( OCP )
定义

📌 Software entities (classes, modules, functions, etc.) should be open for extension, but closed f ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/post/1442515a.html" title="数据库索引">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库索引"></a></div><div class="recent-post-info"><a class="article-title" href="/post/1442515a.html" title="数据库索引">数据库索引</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-14T13:58:26.000Z" title="发表于 2020-09-14 13:58:26">2020-09-14</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%B4%A2%E5%BC%95/">索引</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E7%B4%A2%E5%BC%95/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="content">数据库索引
什么是索引？
索引的类型
数据结构角度

B-Tree 索引
hash 索引
Full-test 索引
R-Tree 索引

物理存储角度
cluster

聚簇索引（聚集索引）：物理索引，与基表的物理顺序相同，数据值的顺序总是按照顺序排列

CREATE CLUSTERED INDEX mycolumn_cindex ON mytable(mycolumn) WITH
ALLOW_DUP_ROW(允许有重复记录的聚簇索引)


非聚簇索引（群集索引）：CREATE UNCLUSTERED INDEX mycolumn_cindex ON mytable(mycolumn)

逻辑角度

唯一索引 CREATE UNIQUE INDEX myclumn_uindex ON mytable(mycolumn)
主键索引（主索引）primary key
(复)组合索引（多列索引）：CREATE INDEX mycolumn_index ON mytable (mycolumn1, mycolumn2)
普通索引（单列索引）：CREATE INDEX mycolumn_index ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/post/6f4c76ae.html" title="String.join()">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="String.join()"></a></div><div class="recent-post-info"><a class="article-title" href="/post/6f4c76ae.html" title="String.join()">String.join()</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-10T11:50:26.000Z" title="发表于 2020-09-10 11:50:26">2020-09-10</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/JDK/">JDK</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/JDK/JDK8/">JDK8</a></span></div><div class="content">String.join()

JDK8 重载了join方法


SpringJoiner
构造函数详细信息
public StringJoiner (CharSequence  delimiter, CharSequence  prefix，CharSequence  suffix )
参数：


delimiter - 添加到的每个元素之间要使用的字符序列


prefix - 开头使用的字符序列


suffix - 最后使用的字符序列
如果 prefix，delimiter 或 suffix  是 null,  则抛出空指针异常。


举例：字符串&quot;[George:Sally:Fred]&quot;可以构造如下:
123StringJoiner sj = new StringJoiner(&quot;:&quot;, &quot;[&quot;, &quot;]&quot;);sj.add(&quot;George&quot;).add(&quot;Sally&quot;).add(&quot;Fred&quot;);String desiredString = sj. ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/post/a256d26f.html" title="Spring Transaction">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spring Transaction"></a></div><div class="recent-post-info"><a class="article-title" href="/post/a256d26f.html" title="Spring Transaction">Spring Transaction</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-08T10:28:59.000Z" title="发表于 2020-09-08 10:28:59">2020-09-08</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Transaction/">Transaction</a></span></div><div class="content">只读事务设置


JDBC 指定只读事务的设置：connection.setReadOnly(true)


Hibernate 只读事务的设置：session.setFlushMode(FlushMode.NEVER)


Spring 只读事务设置：
@Transactional(readOnly = true)
&lt;tx:method name=&quot;search*&quot; read-only=&quot;true&quot; /&gt;



read-only 并不是所有数据库都支持的，不同的数据库下会有不同的结果（例如：对 Mysql 生效，对 Oracle 不生效）。
设置了read-only 后，connection 都会被赋予 read-only（希望数据库驱动开启只读优化，不一定生效） ，不应该把 read-only作为打开只读事务的判断。
在ORM框架中，设置了read-only会赋予一些额外的优化，例如在 Hibernate 中，会被禁止 flush 等。

Oracle 11.2 的文档中表明Oracle JDBC Driver 不支持 read ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/post/96bdb2a7.html" title="JDK 内置注解">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JDK 内置注解"></a></div><div class="recent-post-info"><a class="article-title" href="/post/96bdb2a7.html" title="JDK 内置注解">JDK 内置注解</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-08T09:23:59.000Z" title="发表于 2020-09-08 09:23:59">2020-09-08</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B3%A8%E8%A7%A3/">注解</a></span></div><div class="content">@SuppressWarnings
范围：类、字段、方法、参数、构造方法，以及局部变量上。
作用：告诉编译器忽略指定的警告，不用在编译完成后出现警告信息。
参数：

deprecation：忽略过时
rawtypes：忽略类型安全
unused：忽略不使用
unchecked：忽略安全检查
null：忽略空指针
all：忽略所有

例子：@SuppressWarnings(&quot;unchecked&quot;, &quot;deprecation&quot;)
</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/post/969d9481.html" title="CAS">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CAS"></a></div><div class="recent-post-info"><a class="article-title" href="/post/969d9481.html" title="CAS">CAS</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-06T12:47:26.000Z" title="发表于 2020-09-06 12:47:26">2020-09-06</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%94%81/">锁</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E9%94%81/%E4%B9%90%E8%A7%82%E9%94%81/">乐观锁</a></span></div><div class="content">CAS
什么是CAS

CAS 全称 compare and swap (比较并替换)，是用在线程并发算法里常见的一种思想
CAS 是原子操作，保证并发安全，但不保证并发同步

CAS原理
CAS 就是将内存值更新为需要的值时，设置一个条件，内存值必须与期望值相同

期望值 E、内存值M、更新值U，当E == M的时候将M更新为U

CAS应用

数据库常见的乐观锁实现方式，使用版本号version
JAVA里的原子类

CAS优缺点
优点
用来实现非阻塞的轻量级的乐观锁，通过CPU指令实现，在资源竞争不激烈的情况下性能高
缺点


ABA 问题：线程C、D，线程D将A修改为B后又修改为A，此时C线程以为A没有改变过
JAVA的原子类AtomicStampedReference，通过控制变量值的版本来保证CAS的正确性（其他情况也可以通过增加版本号来解决ABA问题）


自旋时间过长(一直不能更新)，消耗CPU资源， 如果资源竞争激烈，多线程自旋长时间消耗资源


</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/post/5f15bd9e.html" title="JPA用法">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JPA用法"></a></div><div class="recent-post-info"><a class="article-title" href="/post/5f15bd9e.html" title="JPA用法">JPA用法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-06T12:47:26.000Z" title="发表于 2020-09-06 12:47:26">2020-09-06</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Spring/">Spring</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/Spring/Spring-Data/">Spring Data</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/Spring/Spring-Data/Spring-Data-Jpa/">Spring Data Jpa</a></span></div><div class="content">查询用法
实体
12345678910111213141516@Entity@Datapublic class Employee implements Serializable &#123;    @Id    @GeneratedValue(strategy = GenerationType.IDENTITY)    private Long id;    // 拥有级联维护的一方，参考http://westerly-lzh.github.io/cn/2014/12/JPA-CascadeType-Explaining/    @OneToOne(cascade = CascadeType.ALL)     @JoinColumn(foreignKey = @ForeignKey(name = &quot;none&quot;, value = ConstraintMode.NO_CONSTRAINT))    private EmployeeDetail detail;    @ManyToOne(fetch = FetchType.LAZY)     // 设置外键的问题，参考h ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/post/93ac284c.html" title="事务">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="事务"></a></div><div class="recent-post-info"><a class="article-title" href="/post/93ac284c.html" title="事务">事务</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-06T12:47:26.000Z" title="发表于 2020-09-06 12:47:26">2020-09-06</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%BA%8B%E5%8A%A1/">事务</a></span></div><div class="content">事务
什么是事务

所谓的事务，它是一个操作序列，这些操作要么都执行，要么都不执行，是一个不可分割的工作单位。
事务是数据库维护数据一致性的单位，在每个事务结束时，都能保持数据一致性。

事务的四个特性
Atomic 原子性
不同对象之间对于原子性定义不同：


事务性数据库(ACID语境下)：**原子性是指一组对数据库的改变，要么最终成功执行完成，要不就全部回滚。**这就要求数据库系统要实现某种==回滚的机制==，比如redo/undo log。


对于支持并发的编程语言(Java、C++等)：原子性是指一组指令被执行时，不受其他指令的干扰。比如”给一个整型变量赋值是原子的“等等。


一些NoSQL的数据库(Redis)： 事务的原子性的意思更接近于***“一组指令被执行时，不受其他指令的干扰”***，而不是“可以回滚”。


Consistency 一致性
不同的环境下有着不同的含义：

多副本的一致性
一致性hash
CAP理论的一致性
ACID里的一致性

ACID语境下的一致性
AID 都是数据库的特征，也就是依赖数据库的具体实现。但是唯独C不一样，它需要依赖于应用层，也 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/post/f6e7b558.html" title="数据库锁">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库锁"></a></div><div class="recent-post-info"><a class="article-title" href="/post/f6e7b558.html" title="数据库锁">数据库锁</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-06T12:47:26.000Z" title="发表于 2020-09-06 12:47:26">2020-09-06</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%94%81/">锁</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E9%94%81/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="content">数据库锁
锁的分类
按获取锁的方式：

排他锁
共享锁

按系统并发：

悲观锁
乐观锁

按保护对象：

DML锁：

TX行锁
TM表锁


DDL锁：

DDL排他锁
DDL共享锁
DDL可分解解析锁


系统锁：

闩锁Latch
互斥锁Mutexes
内部锁：

字典缓存锁
文件和日志管理锁
表空间和撤销段锁






乐观锁 和 悲观锁 是一种思想
实现形式可能不一样：如 Java的原子类，数据库的version字段

悲观锁
顾名思义，就是很悲观，它对于数据被外界修改持保守态度，认为数据随时会修改，所以整个数据处理中需要将数据加锁。悲观锁一般都是依靠关系数据库提供的锁机制，事实上关系数据库中的行锁，表锁不论是读写锁都是悲观锁。
悲观锁按照使用性质划分
共享锁(S锁)

多个事务可以同时读，但不能有写操作

读锁，事务A对对象T加S锁，其他事务也只能对T加S，直到A释放S锁。
排它锁(X锁)

只有一个事务可以操作，其他事务等待

写锁，事务A对对象T加X锁以后，其他事务不能对T加任何锁，只有事务A可以读写对象T直到A释放X锁。
更新锁(U锁)
用来预定要对此对象施加X锁 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/37/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/37/#content-inner">37</a><span class="page-number current">38</span><a class="page-number" href="/page/39/#content-inner">39</a><a class="page-number" href="/page/40/#content-inner">40</a><a class="extend next" rel="next" href="/page/39/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/images/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Leo Liu</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">400</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">84</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">51</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/liule8"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/LIULE8" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:leo.liu.scau@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">这里是公告</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/a79999eb.html" title="数据结构与算法之基础篇-递归树"><img src="/images/posts/cover/dataStructuresAndAlgorithms.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构与算法之基础篇-递归树"/></a><div class="content"><a class="title" href="/post/a79999eb.html" title="数据结构与算法之基础篇-递归树">数据结构与算法之基础篇-递归树</a><time datetime="2021-11-20T19:27:51.000Z" title="发表于 2021-11-20 19:27:51">2021-11-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/6fd3f48a.html" title="数据结构与算法之基础篇-红黑树(下)"><img src="/images/posts/cover/dataStructuresAndAlgorithms.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构与算法之基础篇-红黑树(下)"/></a><div class="content"><a class="title" href="/post/6fd3f48a.html" title="数据结构与算法之基础篇-红黑树(下)">数据结构与算法之基础篇-红黑树(下)</a><time datetime="2021-11-20T17:23:16.000Z" title="发表于 2021-11-20 17:23:16">2021-11-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/76c8c5cb.html" title="数据结构与算法之基础篇-红黑树(上)"><img src="/images/posts/cover/dataStructuresAndAlgorithms.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构与算法之基础篇-红黑树(上)"/></a><div class="content"><a class="title" href="/post/76c8c5cb.html" title="数据结构与算法之基础篇-红黑树(上)">数据结构与算法之基础篇-红黑树(上)</a><time datetime="2021-11-20T14:13:02.000Z" title="发表于 2021-11-20 14:13:02">2021-11-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/8564d9ad.html" title="数据结构与算法之基础篇-二叉树基础(下)"><img src="/images/posts/cover/dataStructuresAndAlgorithms.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构与算法之基础篇-二叉树基础(下)"/></a><div class="content"><a class="title" href="/post/8564d9ad.html" title="数据结构与算法之基础篇-二叉树基础(下)">数据结构与算法之基础篇-二叉树基础(下)</a><time datetime="2021-11-20T10:42:08.000Z" title="发表于 2021-11-20 10:42:08">2021-11-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/533482d9.html" title="Spark实战之流处理-统一批处理与流处理：Dataflow"><img src="/images/posts/cover/spark.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spark实战之流处理-统一批处理与流处理：Dataflow"/></a><div class="content"><a class="title" href="/post/533482d9.html" title="Spark实战之流处理-统一批处理与流处理：Dataflow">Spark实战之流处理-统一批处理与流处理：Dataflow</a><time datetime="2021-11-20T09:55:00.000Z" title="发表于 2021-11-20 09:55:00">2021-11-20</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/JDK/"><span class="card-category-list-name">JDK</span><span class="card-category-list-count">4</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/JDK/JDK8/"><span class="card-category-list-name">JDK8</span><span class="card-category-list-count">4</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/JVM/"><span class="card-category-list-name">JVM</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/"><span class="card-category-list-name">Java</span><span class="card-category-list-count">83</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"><span class="card-category-list-name">多线程</span><span class="card-category-list-count">81</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/JavaScript/"><span class="card-category-list-name">JavaScript</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MQ/"><span class="card-category-list-name">MQ</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MyBatis/"><span class="card-category-list-name">MyBatis</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Spring/" style="font-size: 1.41em; color: rgb(190, 192, 27)">Spring</a><a href="/tags/JPA/" style="font-size: 1.15em; color: rgb(136, 101, 109)">JPA</a><a href="/tags/Spring-Data/" style="font-size: 1.34em; color: rgb(189, 58, 90)">Spring Data</a><a href="/tags/Vue/" style="font-size: 1.17em; color: rgb(25, 32, 11)">Vue</a><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/" style="font-size: 1.15em; color: rgb(83, 59, 31)">面向对象设计原则</a><a href="/tags/%E6%9E%B6%E6%9E%84/" style="font-size: 1.17em; color: rgb(187, 37, 116)">架构</a><a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 1.3em; color: rgb(43, 170, 40)">算法</a><a href="/tags/UML/" style="font-size: 1.17em; color: rgb(185, 136, 141)">UML</a><a href="/tags/%E9%94%81/" style="font-size: 1.17em; color: rgb(190, 170, 0)">锁</a><a href="/tags/%E9%9B%86%E5%90%88/" style="font-size: 1.15em; color: rgb(54, 194, 40)">集合</a><a href="/tags/%E5%B9%B6%E5%8F%91/" style="font-size: 1.17em; color: rgb(98, 132, 63)">并发</a><a href="/tags/Spring-Data-Jpa/" style="font-size: 1.36em; color: rgb(151, 34, 144)">Spring Data Jpa</a><a href="/tags/%E6%B3%A8%E8%A7%A3/" style="font-size: 1.21em; color: rgb(123, 73, 0)">注解</a><a href="/tags/JVM/" style="font-size: 1.24em; color: rgb(85, 76, 136)">JVM</a><a href="/tags/Java/" style="font-size: 1.45em; color: rgb(66, 125, 78)">Java</a><a href="/tags/CompletableFuture/" style="font-size: 1.15em; color: rgb(129, 174, 180)">CompletableFuture</a><a href="/tags/Future/" style="font-size: 1.15em; color: rgb(112, 159, 16)">Future</a><a href="/tags/JavaScript/" style="font-size: 1.15em; color: rgb(124, 184, 145)">JavaScript</a><a href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" style="font-size: 1.43em; color: rgb(85, 98, 185)">并发编程</a><a href="/tags/%E7%BA%BF%E7%A8%8B/" style="font-size: 1.43em; color: rgb(158, 80, 31)">线程</a><a href="/tags/MySQL/" style="font-size: 1.32em; color: rgb(101, 153, 101)">MySQL</a><a href="/tags/I-O%E6%A8%A1%E5%9E%8B/" style="font-size: 1.39em; color: rgb(172, 142, 61)">I\O模型</a><a href="/tags/Netty/" style="font-size: 1.39em; color: rgb(73, 167, 184)">Netty</a><a href="/tags/Socket%E7%BC%96%E7%A8%8B/" style="font-size: 1.39em; color: rgb(36, 59, 32)">Socket编程</a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.17em; color: rgb(152, 118, 43)">数据库</a><a href="/tags/Oracle/" style="font-size: 1.17em; color: rgb(163, 197, 131)">Oracle</a><a href="/tags/SQL/" style="font-size: 1.17em; color: rgb(45, 18, 40)">SQL</a><a href="/tags/pageable/" style="font-size: 1.15em; color: rgb(150, 64, 20)">pageable</a><a href="/tags/RestTemplate/" style="font-size: 1.15em; color: rgb(164, 61, 24)">RestTemplate</a><a href="/tags/Spark/" style="font-size: 1.26em; color: rgb(130, 25, 21)">Spark</a><a href="/tags/String/" style="font-size: 1.28em; color: rgb(116, 28, 88)">String</a><a href="/tags/Springboot/" style="font-size: 1.19em; color: rgb(148, 176, 170)">Springboot</a><a href="/tags/Annotation/" style="font-size: 1.17em; color: rgb(183, 35, 165)">Annotation</a><a href="/tags/JpaSpecificationExecutor/" style="font-size: 1.19em; color: rgb(37, 149, 69)">JpaSpecificationExecutor</a><a href="/tags/%E4%B9%90%E8%A7%82%E9%94%81/" style="font-size: 1.15em; color: rgb(153, 157, 84)">乐观锁</a><a href="/tags/Spring-Security/" style="font-size: 1.26em; color: rgb(99, 199, 164)">Spring Security</a><a href="/tags/Transaction/" style="font-size: 1.15em; color: rgb(199, 112, 6)">Transaction</a><a href="/tags/redis/" style="font-size: 1.15em; color: rgb(136, 37, 101)">redis</a><a href="/tags/Join/" style="font-size: 1.15em; color: rgb(2, 43, 96)">Join</a><a href="/tags/Time/" style="font-size: 1.15em; color: rgb(22, 107, 149)">Time</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/11/"><span class="card-archive-list-date">十一月 2021</span><span class="card-archive-list-count">59</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/10/"><span class="card-archive-list-date">十月 2021</span><span class="card-archive-list-count">105</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/09/"><span class="card-archive-list-date">九月 2021</span><span class="card-archive-list-count">106</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/08/"><span class="card-archive-list-date">八月 2021</span><span class="card-archive-list-count">27</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/07/"><span class="card-archive-list-date">七月 2021</span><span class="card-archive-list-count">21</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/06/"><span class="card-archive-list-date">六月 2021</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/04/"><span class="card-archive-list-date">四月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/02/"><span class="card-archive-list-date">二月 2021</span><span class="card-archive-list-count">4</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">400</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">1269.1k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2021-11-20T13:32:54.730Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Leo Liu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  fetch('https://api.btstu.cn/yan/api.php?charset=utf-8&encode=json')
    .then(response => response.json())
    .then(data => {
      if (true) {
        var sub = "".length == 0 ? new Array() : "".split(',')
        var both = sub.unshift(data.text)
        typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = data.text
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>